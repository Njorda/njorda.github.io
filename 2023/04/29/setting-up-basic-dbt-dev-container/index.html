<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Setting up a Basic dbt Development Container for BigQuery in GCP - Njord tech blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In this post, you will learn how to set up a basic dbt project in Google Cloud Platform (GCP) and share a development container to kickstart your project. While there are numerous blog posts out there about dbt and BigQuery, none of them share how to set it up in a development container without using any of the dbt-cloud services (at least to my knowledge).
Setting upp your enviorment Set up a gcp project/ or take one you allready have"><meta property="og:image" content><meta property="og:title" content="Setting up a Basic dbt Development Container for BigQuery in GCP"><meta property="og:description" content="In this post, you will learn how to set up a basic dbt project in Google Cloud Platform (GCP) and share a development container to kickstart your project. While there are numerous blog posts out there about dbt and BigQuery, none of them share how to set it up in a development container without using any of the dbt-cloud services (at least to my knowledge).
Setting upp your enviorment Set up a gcp project/ or take one you allready have"><meta property="og:type" content="article"><meta property="og:url" content="https://www.njordy.com/2023/04/29/setting-up-basic-dbt-dev-container/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-29T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-29T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Setting up a Basic dbt Development Container for BigQuery in GCP"><meta name=twitter:description content="In this post, you will learn how to set up a basic dbt project in Google Cloud Platform (GCP) and share a development container to kickstart your project. While there are numerous blog posts out there about dbt and BigQuery, none of them share how to set it up in a development container without using any of the dbt-cloud services (at least to my knowledge).
Setting upp your enviorment Set up a gcp project/ or take one you allready have"><link href=https://www.njordy.com/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://www.njordy.com/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css></head><body><div class=content><header><div class=main><a href=https://www.njordy.com/>Njord tech blog</a></div><nav><a href=../../../../>Home</a>
<a href=../../../../posts>All posts</a>
<a href=../../../../about>About</a></nav></header><main><article><div class=title><h1 class=title>Setting up a Basic dbt Development Container for BigQuery in GCP</h1><div class=meta>Posted on Apr 29, 2023</div></div><section class=body><p>In this post, you will learn how to set up a basic dbt project in Google Cloud Platform (GCP) and share a development container to kickstart your project. While there are numerous blog posts out there about dbt and BigQuery, none of them share how to set it up in a development container without using any of the dbt-cloud services (at least to my knowledge).</p><h2 id=setting-upp-your-enviorment>Setting upp your enviorment</h2><ol><li><p>Set up a gcp project/ or take one you allready have</p></li><li><p>Make sure enabled billing and bq, we will not do anything expensive, it should actually cost close 0 euros to do this short demo. But you need to have it enabled.</p></li><li><p>You can check if bq works by running these queries.</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>    <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#f92672>`</span>dbt<span style=color:#f92672>-</span>tutorial.jaffle_shop.customers<span style=color:#f92672>`</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#f92672>`</span>dbt<span style=color:#f92672>-</span>tutorial.jaffle_shop.orders<span style=color:#f92672>`</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> <span style=color:#f92672>`</span>dbt<span style=color:#f92672>-</span>tutorial.stripe.payment<span style=color:#f92672>`</span>;
</span></span></code></pre></div><ol start=4><li>Create a bq data_set that is multi regional in the EU(I am based in eu, but you can use US if you want)
<img src=../../../../img/dbt_test_create_dataset_bq.png alt="Create dataset"></li></ol><h2 id=running-dbt>Running dbt</h2><ol start=5><li>Ok time to create a dev container! There are two blogg post going over this in depth but the one I used can be found <a href=https://github.com/Njorda/basic-dbt-setup>here</a>. Rember to run the comand below to push your gcp credentials into the container folder.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    cp ~/.config/gcloud/application_default_credentials.json .devcontainer/application_default_credentials.json
</span></span></code></pre></div><ol start=6><li>Time to run initiate the dbt project.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    dbt init 
</span></span></code></pre></div><p>You will now get a number of questions, below you can see the path I suggest taking. However you need to set your project, your dataset and another dbt_project(at least if cloned my container) the mine. The gcp project need to match the key you added in previous step.</p><pre tabindex=0><code>Which database would you like to use?
[1] bigquery

(Don&#39;t see the one you want? https://docs.getdbt.com/docs/available-adapters)

Enter a number: 1
[1] oauth
[2] service_account
Desired authentication method option (enter a number): 1
project (GCP project id): johan-kubeflow
dataset (the name of your dbt dataset): dbt_test
threads (1 or more): 1
job_execution_timeout_seconds [300]: 30
[1] US
[2] EU
Desired location option (enter a number): 2
13:51:38  Profile test_3 written to profiles.yml using target&#39;s profile_template.yml and your supplied values. Run &#39;dbt debug&#39; to validate the connection.
13:51:38  
Your new dbt project &#34;test_3&#34; was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don&#39;t hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!
</code></pre><p>Everything should work now so lets test it!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Bash data-lang=Bash><span style=display:flex><span>    cd test_3
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>    dbt run
</span></span></code></pre></div><p>This should run dbt and populate your bq dataset.
<img src=../../../../img/dbt_test_bq.png alt="This should run dbt and populate your bq dataset."></p><h2 id=conclusion>Conclusion</h2><p>In this post, we learned how to set up a basic dbt project in GCP and share a development container to kickstart our project. With this setup, you can easily</p></section><div class=post-tags></div></article></main><footer><div style=display:flex></div><div class=footer-info>2024 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer></div></body></html>